<?php
$servername = "localhost";
$username = "root";
$password1 = "";
$dbname = "mydb1";

  $conn = new PDO("mysql:host=$servername;dbname=$dbname", $username, $password1);
    // set the PDO error mode to exception
    $conn->setAttribute(PDO::ATTR_ERRMODE, PDO::ERRMODE_EXCEPTION);
	
	//getting values from the form
if(isset($_POST['email'])&& isset($_POST['password']) && isset($_POST['confirm_password']))
{
	$email = $_POST['email'];
	$password = $_POST['password'];
	$param_password = password_hash($password, PASSWORD_DEFAULT);
	$confirm_password = $_POST['confirm_password'];
	$var_md5password = md5($password);
	$usercheck = $email; // email check
	$usercheck = "Select count(*) as count From sign_in WHERE `email`= '" . $usercheck ."'";
	
	$result = $conn->query($usercheck);
	$count = 0;
	while ($row = $result->fetch())
	{
		$count = $row['count'];
		
	}
	
	
	if($count > 0)
	{
		echo '<script type = text/javascript> alert("Value already exists")</script>';
	}
	else
	{
		//Insert data into mysql	
		$sql = "INSERT INTO sign_in (email, password)VALUES('$email', '$param_password')";

		//if the data is inserted successfully display message "Successful"

    $conn->query($sql);
	
	echo '<script type = text/javascript> alert("Thank You for registering with us. Please Sign-in to proceed")</script>';
    
    }
$conn = null;
}
?>
<html>

<head>
</head>
<title> Sign up</title>

<body>

<style><?php  include 'NewStyle.css';?></style>


<form class="pure-form" method = "POST" action = "">

    <fieldset>
	<Center>
        <legend><h1>XYZ Technology</h1></legend>
		<Center>
		<div>
			<div align = "left"><label><b>E-Mail</label></align></div>
		    <input type = "email" placeholder="Enter Email" id="email" name="email" type="email" required>
		<div id="email_error" class="val_error"></div>
		</div>
<br>
		<div>
		<div align = "left"><label><b>Password</label></align></div>
        <input type="password" placeholder="Password" id="password" name="password" minlength = "6" maxlength = "20" pattern = "(?=.*\d)(?=.*[a-z])(?=.*[A-Z]).{6,}" title = "Must contain at least one number and one uppercase and lowercase letter, and at least 6 or more characters" required><br>
		<div align = "left"><label><b>Confirm Password</label></align></div>
        <input type="password" placeholder="Confirm Password" id="confirm_password" name="confirm_password" minlength ="6" maxlength ="20" required>
		<br>
		<div align = "left">
	<p><b> Already a member!!!</b></p>
	<p><b>Please</b> <a href = "Login.html">Sign in</p> 
		<a href = ""><b>Terms and conditions</b></a></p>
		</div>
        <button type="submit" class="pure-button pure-button-primary">Submit</button>
		<br>
    </fieldset>
</form>

</body>
</html>


<script>
var password = document.getElementById("password")
  , confirm_password = document.getElementById("confirm_password");

//Password validation

function validatePassword()
{

  if(password.value != confirm_password.value) 
  {
    confirm_password.setCustomValidity("Passwords Don't Match");
  } 
  else 
  {
    confirm_password.setCustomValidity('');
  }
  
}


password.onchange = validatePassword;
confirm_password.onkeyup = validatePassword;



</script>


